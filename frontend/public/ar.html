<!DOCTYPE html>
<html>
<head>
    <title>Readable Marker AR - SmartTour</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <script>
        // Custom component for 60-second persistence
        AFRAME.registerComponent('marker-persistence', {
            schema: {
                delay: { type: 'number', default: 60000 } // 60 seconds
            },

            init: function () {
                const marker = this.el;
                const delay = this.data.delay;
                const infoCard = marker.querySelector('#info-card');
                let hideTimeout = null;

                infoCard.setAttribute('visible', false);

                marker.addEventListener('markerFound', () => {
                    if (hideTimeout) {
                        clearTimeout(hideTimeout);
                        hideTimeout = null;
                    }
                    infoCard.setAttribute('visible', true);
                });

                marker.addEventListener('markerLost', () => {
                    hideTimeout = setTimeout(() => {
                        infoCard.setAttribute('visible', false);
                    }, delay);
                });
            }
        });
    </script>
</head>

<body style="margin: 0px; overflow: hidden;">

    <a-scene embedded arjs="sourceType: webcam; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">

        <a-marker type="pattern" url="marker.patt" marker-persistence>
        
            <a-entity id="info-card" position="0 0 0" rotation="-90 0 0" look-at="[camera]">
                
                <a-plane 
                    width="1.5" 
                    height="0.7" 
                    position="0 0.4 0"
                    color="#8B5CF6" 
                    material="transparent: true; opacity: 0.9" 
                    rounded="radius: 0.05">
                </a-plane>

                <a-text 
                    value="SmartTour.jo"
                    color="#FFFFFF" 
                    align="center" 
                    width="2.5" 
                    position="0 0.55 0.01">
                </a-text>
                
                <a-text 
                    value="by Nova Squad"
                    color="#E0E0E0"
                    align="center" 
                    width="1.5" 
                    position="0 0.25 0.01">
                </a-text>

            </a-entity>
            
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

</body>
</html>